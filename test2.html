<!DOCTYPE html>
<html>
<head>
  <title>Coordinate Puzzle Game</title>
  <meta charset="utf-8" />
  <style>
    #map { height: 400px; width: 100%; }
    body { font-family: Arial; margin: 20px; }
    input { margin: 5px; }
    #message { margin-top: 10px; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>

<h2>Answer the challenge question</h2>
Answer (number): <input id="answer" type="text" placeholder="e.g. 1">
<button onclick="submitAnswer()">Submit</button>
<button onclick="getLocation()">üìç Show My Location</button>

<div id="message"></div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const challenges = {
    1: { lat: 51.34237252135116, lng: 6.110545230490991, task: "Task 1: Find the object near the first point." },
    2: { lat: 51.34241685183157, lng: 6.112539059710595, task: "Task 2: Look for something red." },
    3: { lat: 51.34242529572773, lng: 6.111508351385206, task: "Task 3: Count the steps here." },
    4: { lat: 51.34235141158354, lng: 6.111183931715576, task: "Task 4: Take a group photo." },
    5: { lat: 51.34233030180616, lng: 6.1110791711972565, task: "Task 5: Check what‚Äôs written on the sign." }
  };

  const map = L.map('map').setView([51.3423, 6.1110], 18);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '¬© OpenStreetMap contributors'
  }).addTo(map);

  let marker;
  let userMarker;

  function submitAnswer() {
  const inputField = document.getElementById('answer');
  const submitBtn = document.querySelector('button[onclick="submitAnswer()"]');
  const input = parseInt(inputField.value);
  const challenge = challenges[input];

  if (challenge) {
    if (marker) map.removeLayer(marker);
    marker = L.marker([challenge.lat, challenge.lng]).addTo(map)
      .bindPopup("üéØ " + challenge.task).openPopup();
    map.setView([challenge.lat, challenge.lng], 20);
    document.getElementById("message").innerText = "‚úÖ Correct! Task unlocked.";
  } else {
    document.getElementById("message").innerText = "‚ùå Incorrect answer. Please wait 30 seconds...";
    
    // Disable input and button
    inputField.disabled = true;
    submitBtn.disabled = true;

    let countdown = 30;
    const originalText = document.getElementById("message").innerText;

    const interval = setInterval(() => {
      countdown--;
      document.getElementById("message").innerText = `‚è≥ Wait ${countdown} seconds...`;
      if (countdown <= 0) {
        clearInterval(interval);
        inputField.disabled = false;
        submitBtn.disabled = false;
        document.getElementById("message").innerText = "‚ùó You can try again now.";
      }
    }, 1000);
  }
}


  function getLocation() {
    if (!navigator.geolocation) {
      document.getElementById("message").innerText = "‚ùå Geolocation not supported.";
      return;
    }

    navigator.geolocation.getCurrentPosition(position => {
      const lat = position.coords.latitude;
      const lng = position.coords.longitude;

      if (userMarker) map.removeLayer(userMarker);
      userMarker = L.marker([lat, lng], { title: "You are here" })
        .addTo(map)
        .bindPopup("üìç Your Location")
        .openPopup();

      map.setView([lat, lng], 19);
      document.getElementById("message").innerText = "üìç Your location is shown on the map.";
    }, () => {
      document.getElementById("message").innerText = "‚ùå Couldn't get your location.";
    });
  }
</script>

</body>
</html>

